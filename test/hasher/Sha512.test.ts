import { expect } from '@assertive-ts/core';
import { Sha512 } from '../../src/hasher/Sha512';

describe('Sha512', () => {
    let hasher: Sha512;

    beforeEach(() => {
        hasher = new Sha512();
    });

    it('should hash data correctly', () => {
        expect(hasher.hash(new Uint8Array()).buffer)
            .toBeEqual(new Uint8Array([207, 131, 225, 53, 126, 239, 184, 189, 241, 84, 40, 80, 214, 109, 128, 7, 214, 32, 228, 5, 11, 87, 21, 220, 131, 244, 169, 33, 211, 108, 233, 206, 71, 208, 209, 60, 93, 133, 242, 176, 255, 131, 24, 210, 135, 126, 236, 47, 99, 185, 49, 189, 71, 65, 122, 129, 165, 56, 50, 122, 249, 39, 218, 62]).buffer);
        expect(hasher.hash(new Uint8Array([107, 115, 97, 100, 104, 108, 195, 182, 109, 97, 115, 99, 50, 57, 56, 48, 56, 57, 113, 119, 101, 114])).buffer)
            .toBeEqual(new Uint8Array([4, 61, 179, 110, 64, 62, 91, 108, 19, 173, 140, 160, 238, 58, 29, 92, 129, 213, 31, 94, 232, 152, 121, 169, 1, 26, 57, 182, 146, 129, 222, 171, 181, 49, 241, 122, 223, 121, 45, 146, 32, 75, 110, 144, 65, 249, 17, 36, 254, 128, 6, 202, 180, 20, 87, 169, 56, 134, 187, 118, 73, 241, 42, 207]).buffer);
    });
});
